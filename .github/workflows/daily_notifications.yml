# .github/workflows/daily_notifications.yml (The FINAL All-in-One Version)

name: Daily Hunter Notifications

on:
  schedule:
    # --- The "Daily Handshake" Reminder (via ntfy) ---
    - cron: '30 1 * * *'    # 7:00 AM IST

    # --- WhatsApp Pings ---
    - cron: '30 0 * * *'    # 6:00 AM IST - Gym Motivation
    - cron: '30 4 * * *'    # 10:00 AM IST - Water Reminder 1
    - cron: '30 7 * * *'    # 1:00 PM IST - Water Reminder 2
    - cron: '30 8 * * *'    # 2:00 PM IST - Afternoon Log Reminder
    - cron: '30 10 * * *'   # 4:00 PM IST - Water Reminder 3
    - cron: '30 13 * * *'   # 7:00 PM IST - Water Reminder 4
    
    # --- The Automatic EOD Report (via WhatsApp) ---
    - cron: '0 16 * * *'    # 9:30 PM IST
    
  workflow_dispatch:
    inputs:
      test_hour:
        description: 'Enter the hour (IST) to test (e.g., 7 for 7 AM, 21 for 9 PM)'
        required: true
        default: '6'

jobs:
  send-notification:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install all dependencies from requirements.txt
        run: pip install -r requirements.txt

      - name: Run Notifier Script
        env:
          TWILIO_ACCOUNT_SID: ${{ secrets.TWILIO_ACCOUNT_SID }}
          TWILIO_AUTH_TOKEN: ${{ secrets.TWILIO_AUTH_TOKEN }}
          TWILIO_FROM_NUMBER: ${{ secrets.TWILIO_FROM_NUMBER }}
          YOUR_WHATSAPP_NUMBER: ${{ secrets.YOUR_WHATSAPP_NUMBER }}
          TEST_HOUR_OVERRIDE: ${{ github.event.inputs.test_hour }} # <-- EE KOTHA LINE ADD CHEY
        run: python notifier.py